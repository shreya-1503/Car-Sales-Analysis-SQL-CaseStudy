                                                     -- Challenge1 - Steeve's Car Showroom 

--Submitted by Shreya Singh 

--Q1. What are the details of all cars purchased in the year 2022?

select c.*, s.purchase_date 
from cars c 
join sales s 
on c.car_id = s.car_id 
where extract(year from s.purchase_date) = 2022;

--Q2. What is the total number of cars sold by each salesperson?

select count(*) as cars_sold, salesman_id 
from sales 
group by salesman_id 
order by salesman_id;

--Q3. What is the total revenue generated by each salesperson?

select s.salesman_id, sum(c.cost_$) as total_revenue 
from cars c join sales s
on c.car_id = s.car_id 
group by s.salesman_id 
order by s.salesman_id;

--Q4. What are the details of the cars sold by each salesperson?

select s.salesman_id, c.* 
from cars c 
join sales s 
on c.car_id = s.car_id 
group by c.car_id, s.salesman_id 
order by s.salesman_id;

--Q5. What is the total revenue generated by each car type?

select type, sum(cost_$) as total_revenue 
from cars 
group by type;

--Q6. What are the details of the cars sold in the year 2021 by salesperson 'Emily Wong'?

select c.* 
from cars c 
join sales s 
on c.car_id = s.car_id 
join Salespersons sp 
on s.salesman_id = sp.salesman_id 
where extract(year from s.purchase_date)=2021 And sp.name = 'Emily Wong';

--Q7. What is the total revenue generated by the sales of hatchback cars?

select sum(cost_$) as total_revenue, style 
from cars 
group by style 
having style ='Hatchback';

--Q8. What is the total revenue generated by the sales of SUV cars in the year 2022?

select sum(c.cost_$) as total_revenue, c.style 
from cars c 
join sales s 
on c.car_id = s.car_id 
group by c.style, s.purchase_date
having c.style = 'SUV' And extract(year from s.purchase_date) = 2022;

--Q9. What is the name and city of the salesperson who sold the most number of cars in the year 2023?

select sp.name, sp.city, count(*) as total_sale 
from salespersons sp 
join sales s 
on s.salesman_id = sp.salesman_id 
where extract(year from s.purchase_date) = 2023 
group by sp.name, sp.city 
order by total_sale desc limit 1;

--Q10. What is the name and age of the salesperson who generated the highest revenue in the year 2022?

select sp.name, sp.age, max(c.cost_$) as max_rev 
from salespersons sp 
join sales s 
on sp.salesman_id = s.salesman_id 
join cars c 
on s.car_id = c.car_id 
where extract(year from s.purchase_date) = 2022 
group by sp.name, sp.age 
order by max_rev desc limit 1;




